import{S as t,i as e,s,n,d as l,f as a,h as c,z as r,E as i,m as o,j as d,k as u,A as h,l as p,q as g,o as v,p as f,x as m,e as y,F as j,G as E,B as T,y as b,H as D,I as x,J as k,r as w}from"../chunks/Q9p8_eM0.js";import{e as C,u as L,d as I}from"../chunks/C0yPXRwU.js";import"../chunks/BzQdJGSh.js";import{s as N}from"../chunks/BskyxVM1.js";function A(t,e,s){const n=t.slice();return n[18]=e[s],n}function M(t,e,s){const n=t.slice();return n[21]=e[s],n}function U(t){let e,s;return{c(){e=v("div"),s=f(t[2]),this.h()},l(n){e=d(n,"DIV",{class:!0});var a=u(e);s=p(a,t[2]),a.forEach(l),this.h()},h(){r(e,"class","error-alert svelte-1gpdjyu")},m(t,n){a(t,e,n),c(e,s)},p(t,e){4&e&&y(s,t[2])},d(t){t&&l(e)}}}function _(t){let e,s,n,i,p,f,m,y='<tr class="svelte-1gpdjyu"><th class="svelte-1gpdjyu">ID</th> <th class="svelte-1gpdjyu">Description</th> <th class="svelte-1gpdjyu">Status</th> <th class="svelte-1gpdjyu">Language</th> <th class="svelte-1gpdjyu">Created</th> <th class="svelte-1gpdjyu">Actions</th></tr>',j=[],T=new Map,b=C(t[0]);const D=t=>t[18].id;for(let l=0;l<b.length;l+=1){let e=A(t,b,l),s=D(e);T.set(s,j[l]=G(s,e))}let x=0===t[0].length&&J();return{c(){e=v("div"),s=v("table"),n=v("thead"),n.innerHTML=y,i=g(),p=v("tbody");for(let t=0;t<j.length;t+=1)j[t].c();f=g(),x&&x.c(),m=E(),this.h()},l(t){e=d(t,"DIV",{class:!0});var a=u(e);s=d(a,"TABLE",{class:!0});var c=u(s);n=d(c,"THEAD",{"data-svelte-h":!0}),"svelte-17d4o1"!==h(n)&&(n.innerHTML=y),i=o(c),p=d(c,"TBODY",{});var r=u(p);for(let e=0;e<j.length;e+=1)j[e].l(r);r.forEach(l),c.forEach(l),a.forEach(l),f=o(t),x&&x.l(t),m=E(),this.h()},h(){r(s,"class","admin-table svelte-1gpdjyu"),r(e,"class","table-container svelte-1gpdjyu")},m(t,l){a(t,e,l),c(e,s),c(s,n),c(s,i),c(s,p);for(let e=0;e<j.length;e+=1)j[e]&&j[e].m(p,null);a(t,f,l),x&&x.m(t,l),a(t,m,l)},p(t,e){4089&e&&(b=C(t[0]),j=L(j,e,D,1,t,b,T,p,I,G,null,A)),0===t[0].length?x||(x=J(),x.c(),x.m(m.parentNode,m)):x&&(x.d(1),x=null)},d(t){t&&(l(e),l(f),l(m));for(let e=0;e<j.length;e+=1)j[e].d();x&&x.d(t)}}}function B(t){let e,s='<div class="loading-spinner svelte-1gpdjyu"></div> <p>Loading moments...</p>';return{c(){e=v("div"),e.innerHTML=s,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-156j5at"!==h(e)&&(e.innerHTML=s),this.h()},h(){r(e,"class","loading-container svelte-1gpdjyu")},m(t,s){a(t,e,s)},p:n,d(t){t&&l(e)}}}function H(t){let e,s,n,i=(t[18].description||"No description")+"";return{c(){e=v("div"),s=f(i),this.h()},l(t){e=d(t,"DIV",{class:!0,title:!0});var n=u(e);s=p(n,i),n.forEach(l),this.h()},h(){r(e,"class","description-text svelte-1gpdjyu"),r(e,"title",n=t[18].description||"")},m(t,n){a(t,e,n),c(e,s)},p(t,l){1&l&&i!==(i=(t[18].description||"No description")+"")&&y(s,i),1&l&&n!==(n=t[18].description||"")&&r(e,"title",n)},d(t){t&&l(e)}}}function V(t){let e,s,n;return{c(){e=v("textarea"),this.h()},l(t){e=d(t,"TEXTAREA",{rows:!0,placeholder:!0,class:!0}),u(e).forEach(l),this.h()},h(){r(e,"rows","3"),r(e,"placeholder","Enter description..."),r(e,"class","svelte-1gpdjyu")},m(l,c){a(l,e,c),T(e,t[4]),s||(n=b(e,"input",t[12]),s=!0)},p(t,s){16&s&&T(e,t[4])},d(t){t&&l(e),s=!1,n()}}}function O(t){let e,s,n,i=(t[18].status||"pending")+"";return{c(){e=v("span"),s=f(i),this.h()},l(t){e=d(t,"SPAN",{class:!0});var n=u(e);s=p(n,i),n.forEach(l),this.h()},h(){r(e,"class",n="status-badge status-"+(t[18].status||"pending")+" svelte-1gpdjyu")},m(t,n){a(t,e,n),c(e,s)},p(t,l){1&l&&i!==(i=(t[18].status||"pending")+"")&&y(s,i),1&l&&n!==(n="status-badge status-"+(t[18].status||"pending")+" svelte-1gpdjyu")&&r(e,"class",n)},d(t){t&&l(e)}}}function F(t){let e,s,n,c=C(t[7]),i=[];for(let l=0;l<c.length;l+=1)i[l]=S(M(t,c,l));return{c(){e=v("select");for(let t=0;t<i.length;t+=1)i[t].c();this.h()},l(t){e=d(t,"SELECT",{class:!0});var s=u(e);for(let e=0;e<i.length;e+=1)i[e].l(s);s.forEach(l),this.h()},h(){r(e,"class","svelte-1gpdjyu"),void 0===t[5]&&k(()=>t[13].call(e))},m(l,c){a(l,e,c);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,null);x(e,t[5],!0),s||(n=b(e,"change",t[13]),s=!0)},p(t,s){if(128&s){let n;for(c=C(t[7]),n=0;n<c.length;n+=1){const l=M(t,c,n);i[n]?i[n].p(l,s):(i[n]=S(l),i[n].c(),i[n].m(e,null))}for(;n<i.length;n+=1)i[n].d(1);i.length=c.length}160&s&&x(e,t[5])},d(t){t&&l(e),D(i,t),s=!1,n()}}}function S(t){let e,s,r=t[21]+"";return{c(){e=v("option"),s=f(r),this.h()},l(t){e=d(t,"OPTION",{});var n=u(e);s=p(n,r),n.forEach(l),this.h()},h(){e.__value=t[21],T(e,e.__value)},m(t,n){a(t,e,n),c(e,s)},p:n,d(t){t&&l(e)}}}function z(t){let e,s=(t[18].language||"Not specified")+"";return{c(){e=f(s)},l(t){e=p(t,s)},m(t,s){a(t,e,s)},p(t,n){1&n&&s!==(s=(t[18].language||"Not specified")+"")&&y(e,s)},d(t){t&&l(e)}}}function P(t){let e,s,n;return{c(){e=v("input"),this.h()},l(t){e=d(t,"INPUT",{placeholder:!0,class:!0}),this.h()},h(){r(e,"placeholder","Language code (e.g., en, es)"),r(e,"class","svelte-1gpdjyu")},m(l,c){a(l,e,c),T(e,t[6]),s||(n=b(e,"input",t[14]),s=!0)},p(t,s){64&s&&e.value!==t[6]&&T(e,t[6])},d(t){t&&l(e),s=!1,n()}}}function q(t){let e,s,n,c,i,u="Edit",p="Delete";function f(){return t[15](t[18])}function m(){return t[16](t[18])}return{c(){e=v("button"),e.textContent=u,s=g(),n=v("button"),n.textContent=p,this.h()},l(t){e=d(t,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1s101mr"!==h(e)&&(e.textContent=u),s=o(t),n=d(t,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1t2s9zv"!==h(n)&&(n.textContent=p),this.h()},h(){r(e,"class","btn btn-edit svelte-1gpdjyu"),r(n,"class","btn btn-delete svelte-1gpdjyu")},m(t,l){a(t,e,l),a(t,s,l),a(t,n,l),c||(i=[b(e,"click",f),b(n,"click",m)],c=!0)},p(e,s){t=e},d(t){t&&(l(e),l(s),l(n)),c=!1,w(i)}}}function R(t){let e,s,c,i,u,p="Save",f="Cancel";return{c(){e=v("button"),e.textContent=p,s=g(),c=v("button"),c.textContent=f,this.h()},l(t){e=d(t,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1txxts7"!==h(e)&&(e.textContent=p),s=o(t),c=d(t,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-gi3vpc"!==h(c)&&(c.textContent=f),this.h()},h(){r(e,"class","btn btn-save svelte-1gpdjyu"),r(c,"class","btn btn-cancel svelte-1gpdjyu")},m(n,l){a(n,e,l),a(n,s,l),a(n,c,l),i||(u=[b(e,"click",t[10]),b(c,"click",t[9])],i=!0)},p:n,d(t){t&&(l(e),l(s),l(c)),i=!1,w(u)}}}function G(t,e){let s,n,i,h,m,j,E,T,b,D,x,k,w,C,L,I=e[18].short_id+"",N=Y(e[18].created_at)+"";function A(t,e){return t[3]?.id===t[18].id?V:H}let M=A(e),U=M(e);function _(t,e){return t[3]?.id===t[18].id?F:O}let B=_(e),S=B(e);function G(t,e){return t[3]?.id===t[18].id?P:z}let J=G(e),X=J(e);function $(t,e){return t[3]?.id===t[18].id?R:q}let K=$(e),Q=K(e);return{key:t,first:null,c(){s=v("tr"),n=v("td"),i=f(I),h=g(),m=v("td"),U.c(),j=g(),E=v("td"),S.c(),T=g(),b=v("td"),X.c(),D=g(),x=v("td"),k=f(N),w=g(),C=v("td"),Q.c(),L=g(),this.h()},l(t){s=d(t,"TR",{class:!0});var e=u(s);n=d(e,"TD",{class:!0});var a=u(n);i=p(a,I),a.forEach(l),h=o(e),m=d(e,"TD",{class:!0});var c=u(m);U.l(c),c.forEach(l),j=o(e),E=d(e,"TD",{class:!0});var r=u(E);S.l(r),r.forEach(l),T=o(e),b=d(e,"TD",{class:!0});var g=u(b);X.l(g),g.forEach(l),D=o(e),x=d(e,"TD",{class:!0});var v=u(x);k=p(v,N),v.forEach(l),w=o(e),C=d(e,"TD",{class:!0});var f=u(C);Q.l(f),f.forEach(l),L=o(e),e.forEach(l),this.h()},h(){r(n,"class","svelte-1gpdjyu"),r(m,"class","description-cell svelte-1gpdjyu"),r(E,"class","svelte-1gpdjyu"),r(b,"class","svelte-1gpdjyu"),r(x,"class","svelte-1gpdjyu"),r(C,"class","actions-cell svelte-1gpdjyu"),r(s,"class","svelte-1gpdjyu"),this.first=s},m(t,e){a(t,s,e),c(s,n),c(n,i),c(s,h),c(s,m),U.m(m,null),c(s,j),c(s,E),S.m(E,null),c(s,T),c(s,b),X.m(b,null),c(s,D),c(s,x),c(x,k),c(s,w),c(s,C),Q.m(C,null),c(s,L)},p(t,s){e=t,1&s&&I!==(I=e[18].short_id+"")&&y(i,I),M===(M=A(e))&&U?U.p(e,s):(U.d(1),U=M(e),U&&(U.c(),U.m(m,null))),B===(B=_(e))&&S?S.p(e,s):(S.d(1),S=B(e),S&&(S.c(),S.m(E,null))),J===(J=G(e))&&X?X.p(e,s):(X.d(1),X=J(e),X&&(X.c(),X.m(b,null))),1&s&&N!==(N=Y(e[18].created_at)+"")&&y(k,N),K===(K=$(e))&&Q?Q.p(e,s):(Q.d(1),Q=K(e),Q&&(Q.c(),Q.m(C,null)))},d(t){t&&l(s),U.d(),S.d(),X.d(),Q.d()}}}function J(t){let e,s="No moments found in the database.";return{c(){e=v("div"),e.textContent=s,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-bzn18h"!==h(e)&&(e.textContent=s),this.h()},h(){r(e,"class","empty-state svelte-1gpdjyu")},m(t,s){a(t,e,s)},d(t){t&&l(e)}}}function X(t){let e,s,m,y,j,E,T,b='<h1 class="svelte-1gpdjyu">Placemarked - Admin</h1> <div class="admin-links svelte-1gpdjyu"><a href="/admin/users" class="svelte-1gpdjyu">Manage Users</a> <a href="/" class="svelte-1gpdjyu">‚Üê Back to Map</a></div>',D=t[2]&&U(t);function x(t,e){return t[1]?B:_}let k=x(t),w=k(t);return{c(){e=g(),s=v("div"),m=v("div"),y=v("div"),y.innerHTML=b,j=g(),D&&D.c(),E=g(),w.c(),T=f("\n\n\n// Force redeploy"),this.h()},l(t){i("svelte-yabzyq",document.head).forEach(l),e=o(t),s=d(t,"DIV",{class:!0});var n=u(s);m=d(n,"DIV",{class:!0});var a=u(m);y=d(a,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-1o3141u"!==h(y)&&(y.innerHTML=b),j=o(a),D&&D.l(a),E=o(a),w.l(a),a.forEach(l),n.forEach(l),T=p(t,"\n\n\n// Force redeploy"),this.h()},h(){document.title="Placemarked - Admin",r(y,"class","admin-header-section svelte-1gpdjyu"),r(m,"class","admin-content svelte-1gpdjyu"),r(s,"class","admin-container svelte-1gpdjyu")},m(t,n){a(t,e,n),a(t,s,n),c(s,m),c(m,y),c(m,j),D&&D.m(m,null),c(m,E),w.m(m,null),a(t,T,n)},p(t,[e]){t[2]?D?D.p(t,e):(D=U(t),D.c(),D.m(m,E)):D&&(D.d(1),D=null),k===(k=x(t))&&w?w.p(t,e):(w.d(1),w=k(t),w&&(w.c(),w.m(m,null)))},i:n,o:n,d(t){t&&(l(e),l(s),l(T)),D&&D.d(),w.d()}}}function Y(t){return new Date(t).toLocaleString()}function $(t,e,s){let n=[],l=!0,a="",c=null,r="",i="",o="";const d=["pending","approved","rejected"];function u(t){s(3,c=t),s(4,r=t.description||""),s(5,i=t.status||"pending"),s(6,o=t.language||"")}function h(){s(3,c=null),s(4,r=""),s(5,i=""),s(6,o="")}async function p(t){if(confirm("Are you sure you want to delete this moment? This action cannot be undone."))try{const{error:e}=await N.from("moments").delete().eq("id",t);if(e)throw e;s(0,n=n.filter(e=>e.id!==t))}catch(e){s(2,a=e instanceof Error?e.message:"Failed to delete moment")}}m(async()=>{await async function(){try{s(1,l=!0);const{data:t,error:e}=await N.from("moments").select("*").order("created_at",{ascending:!1});if(e)throw e;s(0,n=t||[])}catch(t){s(2,a=t instanceof Error?t.message:"Failed to load moments")}finally{s(1,l=!1)}}()});return[n,l,a,c,r,i,o,d,u,h,async function(){if(!c)return;let t=o;if(o&&""!==o.trim()){if(t=o.toLowerCase().trim(),!/^[a-z]{2}$/.test(t))return void s(2,a='Language must be exactly 2 lowercase letters (e.g., "en", "es")')}else t=null;try{console.log("Updating moment:",c.id),console.log("Update data:",{description:r,status:i,language:t});const e={description:r,status:i};null!==t&&(e.language=t);const{data:l,error:a}=await N.from("moments").update(e).eq("id",c.id).select();if(console.log("Update response:",{data:l,error:a}),a)throw a;const d=n.findIndex(t=>t.id===c.id);-1!==d&&s(0,n[d]={...n[d],description:r,status:i,language:o},n),h()}catch(e){s(2,a=e instanceof Error?e.message:"Failed to update moment")}},p,function(){r=this.value,s(4,r)},function(){i=j(this),s(5,i),s(7,d)},function(){o=this.value,s(6,o)},t=>u(t),t=>p(t.id)]}class K extends t{constructor(t){super(),e(this,t,$,X,s,{})}}export{K as component};
